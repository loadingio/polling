!function(){var e=function(){if(s.visible=!document.hidden)return s.list.map(function(n){return n()})},s={inited:!1,visible:"undefined"==typeof document||null===document||!document.hidden,list:[]},n=function(o,r){var n,l,d;return null==r&&(r=1e3),"number"==typeof o&&(o=(n=[r,o])[0],r=n[1]),"undefined"==typeof document||null===document||e.inited||document.addEventListener("visibilitychange",e,!1),s.inited=!0,l={},(d=function(){for(var t,u=this,n=[],e=0,i=arguments.length;e<i;++e)n.push(arguments[e]);return t=n,l.res?Promise.reject(new Error("polling function re-entry blocked")):new Promise(function(n,e){var i;return l.res=n,l.rej=e,l.on=!0,s.list.push(l.run=i=function(){var n=o.apply(u,t);return n?d.stop(n):s.visible&&l.on?l.h=setTimeout(i,r):void 0}),i()})}).stop=function(n){var e;return clearTimeout(l.h),0<=s.list.indexOf(l.run)&&s.list.splice(s.list.indexOf(l.run),1),e=l.res,l.res=null,l.rej=null,l.on=!1,l.run=null,e(n)},d};"undefined"!=typeof module&&null!==module?module.exports=n:"undefined"!=typeof window&&null!==window&&(window.polling=n)}.call(this);
